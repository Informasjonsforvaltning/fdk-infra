apiVersion: keycloak.org/v2alpha1
kind: Keycloak
metadata:
  name: keycloak
spec:
  hostname:
    hostname: https://keycloak.staging.fellesdatakatalog.digdir.no
    admin: https://keycloak-admin.staging.fellesdatakatalog.digdir.no
  instances: 1
  resources:
    requests:
      cpu: 200m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 1Gi
  ingress:
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-dev
  additionalOptions:
    - name: KC_DB_HOST
      secret:
        name: postgres-staging
        key: HOST
    - name: KC_DB_PORT
      secret:
        name: postgres-staging
        key: PORT
    - name: KC_DB_DATABASE
      secret:
        name: keycloak
        key: POSTGRESQL_DB
    - name: KC_DB_USERNAME
      secret:
        name: keycloak
        key: POSTGRESQL_USER
    - name: KC_DB_PASSWORD
      secret:
        name: keycloak
        key: POSTGRESQL_PASSWORD
